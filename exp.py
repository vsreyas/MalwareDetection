import os
import pandas as pd
import numpy as np
import pcaper

def calcFeatures(directory_csv):

    dir_list = os.listdir(directory_csv)
    flag1 = 0
    flag2 = 0
    exp_nm = pd.DataFrame()
    for file in dir_list:
        df = pd.read_csv(os.path.join(directory_csv,file),names=['Word','Frequency'])
        
        if df.iloc[0,1] == 1:
            if flag1 != 0:
                exp_m.join(df.set_index('Word'), on='Word')
                continue
            else:
                exp_m = df
        else:
            if flag2 != 0:
                exp_nm.join(df.set_index('Word'), on='Word')
            else:
                exp_nm = df

    exp_nm['Expected'] = exp_nm.mean(numeric_only=True, axis=1)
    
    df = exp_nm[['Word','Expected']]
    c = os.path.join(directory_csv,'Exp_nm_reduced.csv')
    d = os.path.join(directory_csv,'Exp_nm.csv')
    exp_nm.to_csv(d)
    df.to_csv(c)

    exp_m['Expected'] = exp_m.mean(numeric_only=True, axis=1)
    df1 = exp_m[["Word","Expected"]]
    c = os.path.join(directory_csv,'Exp_m_reduced.csv')
    d = os.path.join(directory_csv,'Exp_m.csv')
    exp_m.to_csv(d)
    df1.to_csv(c)

    return os.path.join(directory_csv,'Exp_m_reduced.csv'), os.path.join(directory_csv,'Exp_nm_reduced.csv')

calcFeatures("trial/http_cv")