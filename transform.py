import numpy as np
import os

def transform(dir_txt, features):
    dir_list = os.listdir(dir_txt)
    s = []
    y = []
    j = 0
    for file in dir_list:
        source = os.path.join(dir_txt, file)
        f = open(source, 'r')
        first_line = f.readline().strip('\n')
        fl = first_line.split()
        y.append(int(fl[1]))
        l = len(features)
        v = np.zeros(l, dtype=np.uint8)

        for line in f:
            for i in range(l):
                word = features[i]
                try:
                    k = line.find(word)
                except:
                    k = -1
                if k >= 0: v[i] = 1
        s.append(v)
        j = j+1
    y = np.array(y)
    s= np.array(s)
    y = y.reshape((j,1))
    
    return s, y
'''
features = np.array(['keep-alive' ,'xml', 'gzip' ,'Accept-Encoding', '0.5', 'en' ,'en-us' ,'Accept'])

print(features)
transform("/home/venky/Documents/IITM Dec/Malware detection using N Grams and SVM/MalDetHTTP/data_p/txt",features)
'''
